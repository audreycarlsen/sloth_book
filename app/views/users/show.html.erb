<div class='profile_info'>

  <div class='profile_table'>
    <table>
      <tr>
        <td><%= image_tag(@user.photo_url, :class => 'style_image') %> </td>
        <td>
          <h1><%= "#{@user.name}" %></h1>
          <p><%= "#{@user.email}" %></p>
          <p><%= "#{@user.sex}" %></p>
        </td>
      </tr>
    </table>
  </div>

  <h2>Friends (<%= @user.friend_count %>)</h2>

  <% @user.friendships.each do |friendship| %>
    <% if friendship.status == 'accepted' %>
      <%= link_to "#{friendship.friend.name}", user_path(friendship.friend.id) %> (<%= link_to 'remove', friendship_path(friendship.id), method: :delete %>)<br>
    <% end %>
  <% end %>

  <% @user.inverse_friendships.each do |inverse_friendship| %>
    <% if inverse_friendship.status == 'accepted' %>
      <%= link_to "#{inverse_friendship.user.name}", user_path(inverse_friendship.user.id) %> <br>
    <% end %>
  <% end %>

</div>

<div class='profile_wall'>
  <% if current_user.find_all_friend_names.include?(@user.name) || current_user == @user %>
    <%= form_for(@post) do |f| %>
      <p>
        <% if @user == current_user %>
          <%= f.label :content, "What's on your mind?"%>
        <% else %>
          <%= f.label :content, "Say something..." %>
        <% end %>
        <br>
        <%= f.text_area :content, :size => '55x5' %>
      </p>

      <%= f.hidden_field :user_id, :value => @user.id %> 
      <%= f.hidden_field :author, :value => current_user.name %>

      <p><%= f.submit("Onward, to glory!")%></p>
    <% end %>
  <% else %>
    Send <%= @user.name %> a <%= link_to "friend request", friendships_path(:friend_id => @user.id), method: :post %>.
  <% end %>

  <% @user.posts.reverse.each do |post| %>
    <div class='post_box'>
      <div class='post_title'>

        <!-- FIX THIS -->
        
        <%= link_to "#{post.author}", user_path(post.author) %>
      </div>
      <div class='post_date'>
        <%= time_ago_in_words(post.created_at).capitalize %> ago
      </div>
      <div class='post_content'>
        <%= post.content %>
      </div>
    </div>
  <% end %>
</div>